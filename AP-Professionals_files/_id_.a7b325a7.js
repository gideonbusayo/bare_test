import{d as k,R as I,G as C,E as F,H as D,I as b,o as E,g as o,c as S,b as l,h as R,e as L,j as _,l as x,a as v,m as z,K as B}from"./entry.f9bbf9c6.js";import{s as M,a as N}from"./index.acd26952.js";import{$ as A}from"./index.33ad9ed7.js";import{_ as V}from"./MoonLoader.vue_vue_type_style_index_0_lang.912bf640.js";import{i as $,c as q}from"./Attributions.c1389bd4.js";import{u as U}from"./index.90356766.js";const O=x(()=>z(()=>import("./FormComponent.c107f357.js"),["./FormComponent.c107f357.js","./FormComponent.vue_vue_type_style_index_0_lang.8914d06a.js","./entry.f9bbf9c6.js","./entry.5ab75024.css","./composables.55c2621b.js","./index.acd26952.js","./TextElement.vue_vue_type_style_index_0_lang.b162ed56.js","./helpers.82f3c343.js","./index.33ad9ed7.js","./index.90356766.js","./Countries.69e07731.js","./FunnelServices.7b0dd86a.js","./FunnelServices.ac84ef2d.css","./utils.72c8fdcc.js","./Recaptcha.vue_vue_type_script_setup_true_lang.67f82be4.js","./optimize_script.058a8464.js","./IntlTel.81f8273c.js","./TextElement.4da2a1d9.css","./funnel_event_helper.bd666bbb.js","./Attributions.c1389bd4.js","./MoonLoader.vue_vue_type_style_index_0_lang.912bf640.js","./MoonLoader.96f1220d.css","./HLConst.970dafa5.js","./InputText.vue_vue_type_script_setup_true_lang.53b45438.js","./FormComponent.52eb3a7e.css","./app.63a239f9.css"],import.meta.url).then(m=>m.default||m)),T={key:0,id:"app",ref:"app"},j={id:"form-builder",class:"hl_wrapper--inner form-builder"},G={class:"loader-container"},H={id:"hl_form_builder_main",class:"hl_form-builder--main"},aa=k({__name:"[id]",async setup(m){var y;let d,u;const t=I({isFormLoaded:!1,form:{},payload:{},urlParams:void 0,url:void 0,referrer:void 0,stickyContactData:void 0,stickyContactFingerprint:void 0,iFrameId:void 0}),f=C(),i=f.params.id,g=f.query.notrack,w=F().public,h=U(),{data:e,error:J}=([d,u]=D(async()=>N("formData",async a=>{var c,n;let r;try{try{r=await A(w.newBaseURL+"/form/"+f.params.id)}catch(s){throw B({statusCode:((c=s==null?void 0:s.response)==null?void 0:c.status)||500,statusMessage:`Failed to get page data: ${((n=s==null?void 0:s.data)==null?void 0:n.msg)||""}`})}return h.value.locationId=r.locationId,{formPayload:r}}catch(s){return console.log("Error caught: ",s.message),{error:s}}})),d=await d,u(),d);e.value&&((y=e.value)==null?void 0:y.error)&&b(e.value.error),E(async()=>{await M(),window.addEventListener("message",function(a){var r;(r=a==null?void 0:a.data)!=null&&r.includes("[iFrameSizer]")&&(console.log("iFrame script is ready!"),window.parent.postMessage(["fetch-sticky-contacts",e.value.formPayload.locationId],"*"),window.parent.postMessage(["fetch-query-params",window.name||"",e.value.formPayload.locationId,i,JSON.stringify({...e.value.formPayload.form.style,width:e.value.formPayload.form.width,height:e.value.formPayload.form.height})],"*"))}),window.parent.postMessage(["iframeLoaded"],"*"),g||($()?window.onmessage=a=>{a.data[0]=="query-params"?(p(a.data[2],a.data[3]),t.urlParams=a.data[1],t.url=a.data[2],t.referrer=a.data[3],t.iFrameId=a.data[4]):a.data[0]=="sticky-contacts"&&(t.stickyContactData=a.data[1],t.stickyContactFingerprint=a.data[2])}:p())});function P(a){t.payload=a}function p(a,r){e.value.formPayload&&(q(e.value.formPayload.locationId,"form",i,e.value.formPayload.name,a,r),window.attribution={locationId:e.value.formPayload.locationId,parentId:i,parentName:e.value.formPayload.name,type:"form"})}return(a,r)=>{var n;const c=O;return(n=o(e))!=null&&n.error?_("",!0):(v(),S("div",T,[l("section",null,[l("section",j,[l("div",G,[R(V,{loading:o(t).isFormLoaded,color:"#188bf6",size:"30px"},null,8,["loading"])]),l("section",H,[o(i)?(v(),L(c,{key:0,formId:o(i),formData:o(e).formPayload,timezone:void 0,calendar:void 0,selectedSlot:void 0,event:void 0,stripeToken:void 0,pageUrl:o(t).url,urlParams:o(t).urlParams,baseReferrrer:o(t).referrer,stickyContactData:o(t).stickyContactData,stickyContactFingerprint:o(t).stickyContactFingerprint,iFrameId:o(t).iFrameId,onStep:P},null,8,["formId","formData","pageUrl","urlParams","baseReferrrer","stickyContactData","stickyContactFingerprint","iFrameId"])):_("",!0)])])])],512))}}});export{aa as default};
